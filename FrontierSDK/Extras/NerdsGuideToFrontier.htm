<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta name=Title content="Nerd’s Guide to Frontier">
<meta name=Keywords content="">
<meta http-equiv=Content-Type content="text/html; charset=macintosh">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 10">
<meta name=Originator content="Microsoft Word 10">
<link rel=File-List href="NerdsGuideToFrontier_files/filelist.xml">
<link rel=Edit-Time-Data href="NerdsGuideToFrontier_files/editdata.mso">
<!--[if !mso]>
<style>
v\:* {behavior:url(#default#VML);}
o\:* {behavior:url(#default#VML);}
w\:* {behavior:url(#default#VML);}
.shape {behavior:url(#default#VML);}
</style>
<![endif]-->
<title>Nerd’s Guide to Frontier</title>
<!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:HyphenationZone>0</w:HyphenationZone>
  <w:DoNotHyphenateCaps/>
  <w:DrawingGridHorizontalSpacing>6 pt</w:DrawingGridHorizontalSpacing>
  <w:DrawingGridVerticalSpacing>6 pt</w:DrawingGridVerticalSpacing>
  <w:DisplayHorizontalDrawingGridEvery>0</w:DisplayHorizontalDrawingGridEvery>
  <w:DisplayVerticalDrawingGridEvery>0</w:DisplayVerticalDrawingGridEvery>
  <w:UseMarginsForDrawingGridOrigin/>
  <w:DoNotShadeFormData/>
  <w:Compatibility>
   <w:OrigWordTableRules/>
   <w:NoLeading/>
   <w:SpaceForUL/>
   <w:BalanceSingleByteDoubleByteWidth/>
   <w:DoNotLeaveBackslashAlone/>
   <w:ULTrailSpace/>
   <w:DoNotExpandShiftReturn/>
   <w:SpacingInWholePoints/>
   <w:ShowBreaksInFrames/>
   <w:SuppressTopSpacing/>
   <w:SuppressTopSpacingMac5/>
   <w:MWSmallCaps/>
   <w:UsePrinterMetrics/>
   <w:WW6BorderRules/>
   <w:FootnoteLayoutLikeWW8/>
   <w:ShapeLayoutLikeWW8/>
   <w:AlignTablesRowByRow/>
   <w:ForgetLastTabAlignment/>
   <w:DoNotUseHTMLParagraphAutoSpacing/>
   <w:LayoutRawTableWidth/>
   <w:LayoutTableRowsApart/>
   <w:UseWord97LineBreakingRules/>
  </w:Compatibility>
 </w:WordDocument>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
@font-face
	{font-family:"Times New Roman";
	panose-1:0 2 2 6 3 5 4 5 2 3;
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:50331648 0 0 0 1 0;}
@font-face
	{font-family:Geneva;
	panose-1:0 2 11 5 3 3 4 4 4 2;
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:50331648 0 0 0 1 0;}
@font-face
	{font-family:"New York";
	panose-1:0 2 2 5 2 6 3 5 6 2;
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:50331648 0 0 0 1 0;}
@font-face
	{font-family:Palatino;
	panose-1:0 2 0 5 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:50331648 0 0 0 1 0;}
 /* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"New York";}
h1
	{mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	mso-outline-level:1;
	font-size:12.0pt;
	font-family:Helvetica;
	mso-font-kerning:0pt;
	text-decoration:underline;
	text-underline:single;}
h2
	{mso-style-next:Normal;
	margin-top:6.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	mso-outline-level:2;
	font-size:12.0pt;
	font-family:Helvetica;}
h3
	{mso-style-next:Normal;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.25in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	mso-outline-level:3;
	font-size:12.0pt;
	font-family:"New York";}
h4
	{mso-style-next:Normal;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.25in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	mso-outline-level:4;
	font-size:12.0pt;
	font-family:"New York";
	text-decoration:underline;
	text-underline:single;
	font-weight:normal;}
h5
	{mso-style-next:Normal;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	mso-outline-level:5;
	font-size:10.0pt;
	font-family:"New York";}
h6
	{mso-style-next:Normal;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	mso-outline-level:6;
	font-size:10.0pt;
	font-family:"New York";
	text-decoration:underline;
	text-underline:single;
	font-weight:normal;}
p.MsoHeading7, li.MsoHeading7, div.MsoHeading7
	{mso-style-next:Normal;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	mso-outline-level:7;
	font-size:10.0pt;
	font-family:"New York";
	font-style:italic;}
 /* Page Definitions */
@page
	{mso-page-border-surround-header:no;
	mso-page-border-surround-footer:no;}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.25in 1.0in 1.25in;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-page-numbers:1;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
-->
</style>
</head>

<body bgcolor=white lang=EN-US style='tab-interval:.5in'>

<div class=Section1>

<h1 style='margin-top:0in'><span style='font-size:28.0pt;text-decoration:none;
text-underline:none'>Nerd’s Guide to Frontier<o:p></o:p></span></h1>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<h1 style='margin-top:0in'><span style='font-size:28.0pt;text-decoration:none;
text-underline:none'>Dave Winer<o:p></o:p></span></h1>

<h1 style='margin-top:0in'><span style='font-size:28.0pt;text-decoration:none;
text-underline:none'>UserLand Software<o:p></o:p></span></h1>

<h2 style='margin-top:20.0pt'><span style='font-size:18.0pt;font-family:Palatino'>Frontier<o:p></o:p></span></h2>

<h3 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;font-weight:normal'>This
article is a top-level technical overview of the UserLand Frontier scripting
system, written for<span style="mso-spacerun: yes">&nbsp; </span>experienced C
or Pascal programmers. The goal is to show how the language and the environment
work, but not to be a complete tutorial in using Frontier. <o:p></o:p></span></h3>

<h3 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;font-weight:normal'>Frontier
is an integrated collection of development tools built around a scripting
language and disk-based storage system. Frontier provides a script
editor/debugger, table editor, menubar editor,<span style="mso-spacerun:
yes">&nbsp; </span>documentation tools and a comprehensive set of built-in
verbs that allow you to customize and automate the Macintosh file system,
operating system, networks, utilities and scriptable applications. <o:p></o:p></span></h3>

<h3 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;font-weight:normal'>Frontier
scripts can be saved to the Finder desktop, can be linked to menu items, and
can run in the background. Scripts can also be embedded in a small application
to allow collections of files, folders and disks to be dropped onto the script.
<o:p></o:p></span></h3>

<h3 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;font-weight:normal'>Frontier
1.0 shipped in January 1992; version 2.0 shipped in October 1992. All the
examples in this article work with Frontier 2.0. <o:p></o:p></span></h3>

<h3 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;font-weight:normal'>In
the following sections we break out each of the major features in Frontier and
discuss them using sample scripts to demonstrate the features.<o:p></o:p></span></h3>

<h2 style='margin-top:20.0pt'><span style='font-size:18.0pt;font-family:Palatino'>The
UserTalk Scripting Language<o:p></o:p></span></h2>

<h3 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;font-weight:normal'>UserTalk
is a full-featured language, with looping, if-then-else, case statements, local
and persistent variables, subroutines, error recovery and automatic type
coercion. UserTalk’s syntax is most like C or Pascal. The language is very
tightly integrated with Frontier’s object database, discussed in the “Storage
System” section, below.<o:p></o:p></span></h3>

<h3 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;font-weight:normal'>The
goal of the language is to make it easy to write utilities that operate at the
system level; launching and communicating with applications, managing the file
system and operating system and other system resources, and moving information
around a network. <o:p></o:p></span></h3>

<span style='font-size:18.0pt;font-family:Palatino;mso-ansi-language:EN-US'><b><br
clear=ALL style='page-break-before:always'>
</b></span>

<h2 style='margin-top:20.0pt'><span style='font-size:18.0pt;font-family:Palatino'>Hello
World<o:p></o:p></span></h2>

<h3 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;font-weight:normal'>There’s
a long tradition of introducing languages with a simple “Hello World” program.
Here’s what Hello World looks like in UserTalk:<o:p></o:p></span></h3>

<h4 style='margin-top:2.35pt;margin-right:0in;margin-bottom:2.35pt;margin-left:
.2in'><span style='font-size:9.0pt;font-family:Geneva;text-decoration:none;
text-underline:none'>msg (&quot;Hello World!&quot;)<o:p></o:p></span></h4>

<h3 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;font-weight:normal'>This
displays the string in Frontier’s main window:<o:p></o:p></span></h3>

<h4 align=center style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;
margin-left:0in;margin-bottom:.0001pt;text-align:center'><!--[if gte vml 1]><v:shapetype
 id="_x0000_t75" coordsize="21600,21600" o:spt="75" o:preferrelative="t"
 path="m@4@5l@4@11@9@11@9@5xe" filled="f" stroked="f">
 <v:stroke joinstyle="miter"/>
 <v:formulas>
  <v:f eqn="if lineDrawn pixelLineWidth 0"/>
  <v:f eqn="sum @0 1 0"/>
  <v:f eqn="sum 0 0 @1"/>
  <v:f eqn="prod @2 1 2"/>
  <v:f eqn="prod @3 21600 pixelWidth"/>
  <v:f eqn="prod @3 21600 pixelHeight"/>
  <v:f eqn="sum @0 0 1"/>
  <v:f eqn="prod @6 1 2"/>
  <v:f eqn="prod @7 21600 pixelWidth"/>
  <v:f eqn="sum @8 21600 0"/>
  <v:f eqn="prod @7 21600 pixelHeight"/>
  <v:f eqn="sum @10 21600 0"/>
 </v:formulas>
 <v:path o:extrusionok="f" gradientshapeok="t" o:connecttype="rect"/>
 <o:lock v:ext="edit" aspectratio="t"/>
</v:shapetype><v:shape id="_x0000_i1025" type="#_x0000_t75" style='width:402pt;
 height:25pt'>
 <v:imagedata src="NerdsGuideToFrontier_files/image001.gif" o:althref="NerdsGuideToFrontier_files/image002.pct"
  o:title=""/>
</v:shape><![endif]--><![if !vml]><img width=402 height=25
src="NerdsGuideToFrontier_files/image003.gif" v:shapes="_x0000_i1025"><![endif]><span
style='font-family:Palatino;text-decoration:none;text-underline:none'><o:p></o:p></span></h4>

<h2 style='margin-top:20.0pt'><span style='font-size:18.0pt;font-family:Palatino'>Built-in
Verbs<o:p></o:p></span></h2>

<h3 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;font-weight:normal'>Let’s
look at a more comprehensive script that creates aliases of all applications on
all hard disks in the Apple Menu Items folder:<o:p></o:p></span></h3>

<h4 style='margin-top:2.35pt;margin-right:0in;margin-bottom:2.35pt;margin-left:
.2in'><span style='font-size:9.0pt;font-family:Geneva;text-decoration:none;
text-underline:none'>local (appleFolder = file.getSpecialFolderPath
(&quot;&quot;, &quot;Apple Menu Items&quot;, true))<o:p></o:p></span></h4>

<h4 style='margin-top:2.35pt;margin-right:0in;margin-bottom:2.35pt;margin-left:
.2in'><span style='font-size:9.0pt;font-family:Geneva;text-decoration:none;
text-underline:none'>fileloop (f in &quot;&quot;, infinity) «scan over all
disks, to infinite depth<o:p></o:p></span></h4>

<h5 style='margin-top:2.35pt;margin-right:0in;margin-bottom:2.35pt;margin-left:
.4in'><span style='font-size:9.0pt;font-family:Geneva;font-weight:normal'>if
file.type (f) == 'APPL' «it’s an application<o:p></o:p></span></h5>

<h6 style='margin-top:2.35pt;margin-right:0in;margin-bottom:2.35pt;margin-left:
.6in'><span style='font-size:9.0pt;font-family:Geneva;text-decoration:none;
text-underline:none'>local (name = file.fileFromPath (f)) «copy the file’s name
into a local<o:p></o:p></span></h6>

<h6 style='margin-top:2.35pt;margin-right:0in;margin-bottom:2.35pt;margin-left:
.6in'><span style='font-size:9.0pt;font-family:Geneva;text-decoration:none;
text-underline:none'>if dialog.yesNo (&quot;Create alias of “&quot; + name +
&quot;” in Apple Menu Items folder?&quot;)<o:p></o:p></span></h6>

<p class=MsoHeading7 style='margin-top:2.35pt;margin-right:0in;margin-bottom:
2.35pt;margin-left:.8in'><span style='font-size:9.0pt;font-family:Geneva;
font-style:normal'>file.newAlias (f, appleFolder + name + &quot; alias&quot;)<o:p></o:p></span></p>

<h3 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;font-weight:normal'>The
script loops over all files, and when it finds one whose type is 'APPL', it
displays a “yesNo” dialog asking if you want to create the alias. If you click
on Yes, the script calls the Frontier built-in file.newAlias verb to create the
alias in the Apple Menu Items folder.<o:p></o:p></span></h3>

<h3 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;font-weight:normal'>“fileloop”
is a special construct in UserTalk, it allows you to iterate over all the files
on a disk or<span style="mso-spacerun: yes">&nbsp; </span>in a folder. If the
path is the empty string, fileloop will loop over all mounted disks. By saying
we want to go to infinite depth, the loop will visit all files in all
sub-folders, no matter how deeply nested.<o:p></o:p></span></h3>

<h3 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;font-weight:normal'>We
could have hard-coded a path to the Apple Menu Items folder, but by calling
file.getSpecialFolderPath this script will work on any Macintosh, in any
country. For example, in the Fredonia version of System 7, this call will
return “Sturgeon:Smidgadzchen Festerest:Apfel Menu Gethingies”. (With apologies
to the good citizens of Freedonia…)<o:p></o:p></span></h3>

<h3 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;font-weight:normal'>file.getSpecialFolderPath,
file.type, file.fileFromPath, dialog.yesNo and file.newAlias are examples of
calls to built-in verbs. Generally, if the Macintosh OS provides an API for a
system-oriented operation, Frontier provides a simple scripting API for that
operation.<o:p></o:p></span></h3>

<span style='font-size:12.0pt;font-family:Palatino;mso-ansi-language:EN-US'><br
clear=ALL style='page-break-before:always'>
</span>

<h3 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;font-weight:normal'>As
examples, Frontier 2.0 includes built-in verbs that allow you to:<o:p></o:p></span></h3>

<h4 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
.3in;margin-bottom:.0001pt;text-indent:-13.0pt'><span style='font-family:Palatino;
text-decoration:none;text-underline:none'>•<span style='mso-tab-count:1'>&nbsp; </span>Launch
an application, data file, control panel, or desk accessory. Loop over all
running applications. Bring an application to the front. Access the desktop
database.<o:p></o:p></span></h4>

<h4 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
.3in;margin-bottom:.0001pt;text-indent:-13.0pt'><span style='font-family:Palatino;
text-decoration:none;text-underline:none'>•<span style='mso-tab-count:1'>&nbsp; </span>Move,
copy, delete or rename files and folders. Get and modify file/folder attributes
such as the creation date, modification date, file type and creator, size, file
comment, version information, icon position. Determine whether a file is
visible or not visible, locked or unlocked, busy or not. Reconcile the changes
between two versions of the same folder.<o:p></o:p></span></h4>

<h4 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
.3in;margin-bottom:.0001pt;text-indent:-13.0pt'><span style='font-family:Palatino;
text-decoration:none;text-underline:none'>•<span style='mso-tab-count:1'>&nbsp; </span>Manage
the resource fork of any file. Read and write text files and data files. Access
the system clock. Move data in and out of the clipboard.<o:p></o:p></span></h4>

<h3 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;font-weight:normal'>Frontier
is itself completely scriptable and includes built-in verbs to manage its
object database script, outline, text and picture windows.<o:p></o:p></span></h3>

<span style='font-size:18.0pt;font-family:Palatino;mso-ansi-language:EN-US'><b><br
clear=ALL style='page-break-before:always'>
</b></span>

<h2 style='margin-top:20.0pt'><span style='font-size:18.0pt;font-family:Palatino'>Interapplication
Messaging<o:p></o:p></span></h2>

<h3 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;font-weight:normal'>Scripts
that drive applications look very much like scripts that drive the file system
and operating system. <o:p></o:p></span></h3>

<h3 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;font-weight:normal'>Here’s
a script that creates a StuffIt archive containing compressed versions of all
files on all disks modified after May 15, 1993:<o:p></o:p></span></h3>

<h4 style='margin-top:2.35pt;margin-right:0in;margin-bottom:2.35pt;margin-left:
.2in'><span style='font-size:9.0pt;font-family:Geneva;text-decoration:none;
text-underline:none'>local (archive = &quot;System:Desktop Folder:Changed
Files.sit&quot;)<o:p></o:p></span></h4>

<h4 style='margin-top:2.35pt;margin-right:0in;margin-bottom:2.35pt;margin-left:
.2in'><span style='font-size:9.0pt;font-family:Geneva;text-decoration:none;
text-underline:none'>if file.exists (archive)<o:p></o:p></span></h4>

<h5 style='margin-top:2.35pt;margin-right:0in;margin-bottom:2.35pt;margin-left:
.4in'><span style='font-size:9.0pt;font-family:Geneva;font-weight:normal'>file.delete
(archive)<o:p></o:p></span></h5>

<h4 style='margin-top:2.35pt;margin-right:0in;margin-bottom:2.35pt;margin-left:
.2in'><span style='font-size:9.0pt;font-family:Geneva;text-decoration:none;
text-underline:none'>StuffIt.launch ()<o:p></o:p></span></h4>

<h4 style='margin-top:2.35pt;margin-right:0in;margin-bottom:2.35pt;margin-left:
.2in'><span style='font-size:9.0pt;font-family:Geneva;text-decoration:none;
text-underline:none'>StuffIt.newArchive (archive, false) «create a 3.0-format
archive, not 1.5.1<o:p></o:p></span></h4>

<h4 style='margin-top:2.35pt;margin-right:0in;margin-bottom:2.35pt;margin-left:
.2in'><span style='font-size:9.0pt;font-family:Geneva;text-decoration:none;
text-underline:none'>StuffIt.bringToFront ()<o:p></o:p></span></h4>

<h4 style='margin-top:2.35pt;margin-right:0in;margin-bottom:2.35pt;margin-left:
.2in'><span style='font-size:9.0pt;font-family:Geneva;text-decoration:none;
text-underline:none'>fileloop (f in &quot;&quot;, infinity)<o:p></o:p></span></h4>

<h5 style='margin-top:2.35pt;margin-right:0in;margin-bottom:2.35pt;margin-left:
.4in'><span style='font-size:9.0pt;font-family:Geneva;font-weight:normal'>if
file.modified (f) &gt; date (&quot;May 15, 1993&quot;)<o:p></o:p></span></h5>

<h6 style='margin-top:2.35pt;margin-right:0in;margin-bottom:2.35pt;margin-left:
.6in'><span style='font-size:9.0pt;font-family:Geneva;text-decoration:none;
text-underline:none'>StuffIt.stuffItem (f)<o:p></o:p></span></h6>

<h4 style='margin-top:2.35pt;margin-right:0in;margin-bottom:2.35pt;margin-left:
.2in'><span style='font-size:9.0pt;font-family:Geneva;text-decoration:none;
text-underline:none'>StuffIt.closeArchive (archive)<o:p></o:p></span></h4>

<h3 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;font-weight:normal'>The
new archive appears on the desktop. We delete the file if it already exists.
Then we launch StuffIt Lite 3.0, create the new archive, and loop over all
files on all disks. If a file’s modification date is greater than May 15, 1993,
we add the file to the archive. When the loop completes, we close the archive.<o:p></o:p></span></h3>

<h3 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;font-weight:normal'>The
verbs StuffIt.newArchive,<span style="mso-spacerun: yes">&nbsp;
</span>StuffIt.stuffItem, and StuffIt.closeArchive result in an Apple Event
being sent to the StuffIt application. But this fact is invisible to the script
writer. You call StuffIt from a script exactly as if you were calling a
built-in verb. The only difference is that you have to launch the StuffIt
application in order to call it.<o:p></o:p></span></h3>

<h3 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;font-weight:normal'>Here’s
what the script for StuffIt.stuffItem looks like:<o:p></o:p></span></h3>

<h4 style='margin-top:2.35pt;margin-right:0in;margin-bottom:2.35pt;margin-left:
.2in'><span style='font-size:9.0pt;font-family:Geneva;text-decoration:none;
text-underline:none'>on stuffItem (path) «return true if StuffIt was able to
add the file to the current archive<o:p></o:p></span></h4>

<h5 style='margin-top:2.35pt;margin-right:0in;margin-bottom:2.35pt;margin-left:
.4in'><span style='font-size:9.0pt;font-family:Geneva;font-weight:normal'>return
(appleEvent (StuffIt.id, 'SIT!', 'Stuf', 'path', string (path)) == 0)<o:p></o:p></span></h5>

<h3 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;font-weight:normal'>More
information on the built-in appleEvent verb is included in the Q&amp;A section
at the end of the article.<o:p></o:p></span></h3>

<span style='font-size:18.0pt;font-family:Palatino;mso-ansi-language:EN-US'><b><br
clear=ALL style='page-break-before:always'>
</b></span>

<h2 style='margin-top:20.0pt'><span style='font-size:18.0pt;font-family:Palatino'>Object
Model Scripting<o:p></o:p></span></h2>

<h3 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;font-weight:normal'>Some
applications implement the richer “object model” style of Apple Events. Scripts
that drive object model applications can look very different from scripts that
drive simpler scripting APIs, as illustrated in the previous example.<o:p></o:p></span></h3>

<h3 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;font-weight:normal'>Here’s
a script that opens a FileMaker Pro 2.0 database containing information about
the 50 states in the United States. It creates a text file that lists each
state and its capital on a separate line:<o:p></o:p></span></h3>

<h4 style='margin-top:2.35pt;margin-right:0in;margin-bottom:2.35pt;margin-left:
.2in'><span style='font-size:9.0pt;font-family:Geneva;text-decoration:none;
text-underline:none'>local (textfile = &quot;System:States Text&quot;, database
= &quot;System:States Database&quot;)<o:p></o:p></span></h4>

<h4 style='margin-top:2.35pt;margin-right:0in;margin-bottom:2.35pt;margin-left:
.2in'><span style='font-size:9.0pt;font-family:Geneva;text-decoration:none;
text-underline:none'>file.new (textfile) «create the file, its length is 0
bytes<o:p></o:p></span></h4>

<h4 style='margin-top:2.35pt;margin-right:0in;margin-bottom:2.35pt;margin-left:
.2in'><span style='font-size:9.0pt;font-family:Geneva;text-decoration:none;
text-underline:none'>file.setType (textfile, 'TEXT') «it's a text file<o:p></o:p></span></h4>

<h4 style='margin-top:2.35pt;margin-right:0in;margin-bottom:2.35pt;margin-left:
.2in'><span style='font-size:9.0pt;font-family:Geneva;text-decoration:none;
text-underline:none'>file.setCreator (textfile, 'ttxt') «it can be opened by
TeachText<o:p></o:p></span></h4>

<h4 style='margin-top:2.35pt;margin-right:0in;margin-bottom:2.35pt;margin-left:
.2in'><span style='font-size:9.0pt;font-family:Geneva;text-decoration:none;
text-underline:none'>file.open (textfile) «open the data fork of the file<o:p></o:p></span></h4>

<h4 style='margin-top:2.35pt;margin-right:0in;margin-bottom:2.35pt;margin-left:
.2in'><span style='font-size:9.0pt;font-family:Geneva;text-decoration:none;
text-underline:none'>app.startWithDocument (&quot;FileMaker&quot;, database)<o:p></o:p></span></h4>

<h4 style='margin-top:2.35pt;margin-right:0in;margin-bottom:2.35pt;margin-left:
.2in'><span style='font-size:9.0pt;font-family:Geneva;text-decoration:none;
text-underline:none'>with FileMaker, objectModel «use FileMaker and object
model vocabularies<o:p></o:p></span></h4>

<h5 style='margin-top:2.35pt;margin-right:0in;margin-bottom:2.35pt;margin-left:
.4in'><span style='font-size:9.0pt;font-family:Geneva;font-weight:normal'>local
(i)<o:p></o:p></span></h5>

<h5 style='margin-top:2.35pt;margin-right:0in;margin-bottom:2.35pt;margin-left:
.4in'><span style='font-size:9.0pt;font-family:Geneva;font-weight:normal'>show
(record [all]) «select all records<o:p></o:p></span></h5>

<h5 style='margin-top:2.35pt;margin-right:0in;margin-bottom:2.35pt;margin-left:
.4in'><span style='font-size:9.0pt;font-family:Geneva;font-weight:normal'>for i
= 1 to count (layout [1], record) «loop over all the records<o:p></o:p></span></h5>

<h6 style='margin-top:2.35pt;margin-right:0in;margin-bottom:2.35pt;margin-left:
.6in'><span style='font-size:9.0pt;font-family:Geneva;text-decoration:none;
text-underline:none'>local (stateName, stateCapital)<o:p></o:p></span></h6>

<h6 style='margin-top:2.35pt;margin-right:0in;margin-bottom:2.35pt;margin-left:
.6in'><span style='font-size:9.0pt;font-family:Geneva;text-decoration:none;
text-underline:none'>stateName = get (record [i].cell [&quot;Name&quot;])<o:p></o:p></span></h6>

<h6 style='margin-top:2.35pt;margin-right:0in;margin-bottom:2.35pt;margin-left:
.6in'><span style='font-size:9.0pt;font-family:Geneva;text-decoration:none;
text-underline:none'>stateCapital = get (record [i].cell [&quot;Capital&quot;])<o:p></o:p></span></h6>

<h6 style='margin-top:2.35pt;margin-right:0in;margin-bottom:2.35pt;margin-left:
.6in'><span style='font-size:9.0pt;font-family:Geneva;text-decoration:none;
text-underline:none'>file.write (textfile, stateCapital + tab + stateName + cr)<o:p></o:p></span></h6>

<h4 style='margin-top:2.35pt;margin-right:0in;margin-bottom:2.35pt;margin-left:
.2in'><span style='font-size:9.0pt;font-family:Geneva;text-decoration:none;
text-underline:none'>file.close (textfile)<o:p></o:p></span></h4>

<h4 style='margin-top:2.35pt;margin-right:0in;margin-bottom:2.35pt;margin-left:
.2in'><span style='font-size:9.0pt;font-family:Geneva;text-decoration:none;
text-underline:none'>FileMaker.quit ()<o:p></o:p></span></h4>

<h3 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;font-weight:normal'>In
this example, we create a text file on the disk named System, set its type and
creator, and open its data fork. We launch the FileMaker application, telling
it to open the States Database.<o:p></o:p></span></h3>

<h3 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;font-weight:normal'>We
access FileMaker’s terminology by including the FileMaker-related script code
inside the “with” statement. When we refer to count (layout [1], record) we’re
asking FileMaker for the number of records when viewed thru the first layout.
We make sure all the records are selected. Then we loop over all the records in
the database, copying the state name and capital into locals, then writing a
line to the text file. After looping over all the records, we close the text
file and quit the FileMaker application.<o:p></o:p></span></h3>

<span style='font-size:18.0pt;font-family:Palatino;mso-ansi-language:EN-US'><b><br
clear=ALL style='page-break-before:always'>
</b></span>

<h2 style='margin-top:20.0pt'><span style='font-size:18.0pt;font-family:Palatino'>Script
editor<o:p></o:p></span></h2>

<h3 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;font-weight:normal'>Frontier
has a full-featured, integrated script editor.<o:p></o:p></span></h3>

<h3 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;font-weight:normal'>Here’s
what the first sample script looks like in a Frontier script editing window:<o:p></o:p></span></h3>

<h4 align=center style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;
margin-left:0in;margin-bottom:.0001pt;text-align:center'><!--[if gte vml 1]><v:shape
 id="_x0000_i1026" type="#_x0000_t75" style='width:444pt;height:169pt'>
 <v:imagedata src="NerdsGuideToFrontier_files/image004.gif" o:althref="NerdsGuideToFrontier_files/image005.pct"
  o:title=""/>
</v:shape><![endif]--><![if !vml]><img width=444 height=169
src="NerdsGuideToFrontier_files/image006.gif" v:shapes="_x0000_i1026"><![endif]><span
style='font-family:Palatino;text-decoration:none;text-underline:none'><o:p></o:p></span></h4>

<h3 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;font-weight:normal'>Frontier
scripts are outlines. You could collapse the fileloop statement to show none of
its sub-heads, or one of them, or all of them. You can control the level of
detail you want to view. Outlining also helps you edit the structure of your
scripts. Drag a headline to a new location, and all the sub-heads move with it.
Programs are hierarchies. Outliners are hierarchy editors. It makes a lot of
sense to have a script editing tool that understands hierarchic program
structure.<o:p></o:p></span></h3>

<h3 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;font-weight:normal'>One
of the fallouts of this design is that structure symbols such as curly braces
and semi-colons are unnecessary when you edit a script using Frontier’s script
editor. The structure of the outline is the structure of the program and vice
versa.<o:p></o:p></span></h3>

<h3 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;font-weight:normal'>The
window title shows the object database address for this script. It’s located in
the deskscripts sub-table of the system table. Its name is appsToAppleMenu.
Details on the object database are in the “Storage System” section, below.<o:p></o:p></span></h3>

<h3 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;font-weight:normal'>This
screen shot was taken using a development version of Frontier that supports
multiple scripting components. To the left of the horizontal scrollbar is a
popup menu that allows you to select the scripting component to run the script.
This allows you to edit an AppleScript script within Frontier and call it from
any other script. In fact, you can edit a script in any OSA-compatible
scripting language. This includes a new version of CE Software’s QuicKeys macro
utility, currently in development.<o:p></o:p></span></h3>

<span style='font-size:12.0pt;font-family:Palatino;mso-ansi-language:EN-US'><br
clear=ALL style='page-break-before:always'>
</span>

<h3 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;font-weight:normal'>You
can find and replace within a single script and over groups of scripts. Options
include case insensitive searching, wrap around, find only language identifiers
or whole words. Here’s a screen shot of Frontier’s Find &amp; Replace window:<o:p></o:p></span></h3>

<h4 align=center style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;
margin-left:0in;margin-bottom:.0001pt;text-align:center'><!--[if gte vml 1]><v:shape
 id="_x0000_i1027" type="#_x0000_t75" style='width:442pt;height:124pt'>
 <v:imagedata src="NerdsGuideToFrontier_files/image007.gif" o:althref="NerdsGuideToFrontier_files/image008.pct"
  o:title=""/>
</v:shape><![endif]--><![if !vml]><img width=442 height=124
src="NerdsGuideToFrontier_files/image009.gif" v:shapes="_x0000_i1027"><![endif]><span
style='font-family:Palatino;text-decoration:none;text-underline:none'><o:p></o:p></span></h4>

<h3 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;font-weight:normal'>The
script editor is itself scriptable, so you can write tools that automate script
development. <o:p></o:p></span></h3>

<span style='font-size:18.0pt;font-family:Palatino;mso-ansi-language:EN-US'><b><br
clear=ALL style='page-break-before:always'>
</b></span>

<h2 style='margin-top:20.0pt'><span style='font-size:18.0pt;font-family:Palatino'>Debugger<o:p></o:p></span></h2>

<h3 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;font-weight:normal'>The
script editor also provides the interface for debugging. Here’s what a script
editing window looks like after you click on the Debug button:<o:p></o:p></span></h3>

<h4 align=center style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;
margin-left:0in;margin-bottom:.0001pt;text-align:center'><!--[if gte vml 1]><v:shape
 id="_x0000_i1028" type="#_x0000_t75" style='width:434pt;height:201pt'>
 <v:imagedata src="NerdsGuideToFrontier_files/image010.gif" o:althref="NerdsGuideToFrontier_files/image011.pct"
  o:title=""/>
</v:shape><![endif]--><![if !vml]><img width=434 height=201
src="NerdsGuideToFrontier_files/image012.gif" v:shapes="_x0000_i1028"><![endif]><span
style='font-family:Palatino;text-decoration:none;text-underline:none'><o:p></o:p></span></h4>

<h3 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;font-weight:normal'>The
buttons at the top of the window are handled by Frontier’s integrated script debugger.
You can step from statement to statement, go into a script call, step out from
a script call, follow statement execution, resume normal execution, or halt the
script. You can examine and edit all local and global variables in the storage
system while any number of scripts are running. You can set a breakpoint at any
statement.<o:p></o:p></span></h3>

<span style='font-size:12.0pt;font-family:Palatino;mso-ansi-language:EN-US'><br
clear=ALL style='page-break-before:always'>
</span>

<h3 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;font-weight:normal'>For
example, if you set a breakpoint on the file.newAlias call, and clicked on
Lookup with the name appleFolder selected, as shown below:<o:p></o:p></span></h3>

<h4 align=center style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;
margin-left:0in;margin-bottom:.0001pt;text-align:center'><!--[if gte vml 1]><v:shape
 id="_x0000_i1029" type="#_x0000_t75" style='width:434pt;height:201pt'>
 <v:imagedata src="NerdsGuideToFrontier_files/image013.gif" o:althref="NerdsGuideToFrontier_files/image014.pct"
  o:title=""/>
</v:shape><![endif]--><![if !vml]><img width=434 height=201
src="NerdsGuideToFrontier_files/image015.gif" v:shapes="_x0000_i1029"><![endif]><span
style='font-family:Palatino;text-decoration:none;text-underline:none'><o:p></o:p></span></h4>

<h3 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;font-weight:normal'>You’d
see the top-level stack frame for this script. This table is fully editable:<o:p></o:p></span></h3>

<h4 align=center style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;
margin-left:0in;margin-bottom:.0001pt;text-align:center'><!--[if gte vml 1]><v:shape
 id="_x0000_i1030" type="#_x0000_t75" style='width:452pt;height:121pt'>
 <v:imagedata src="NerdsGuideToFrontier_files/image016.gif" o:althref="NerdsGuideToFrontier_files/image017.pct"
  o:title=""/>
</v:shape><![endif]--><![if !vml]><img width=452 height=121
src="NerdsGuideToFrontier_files/image018.gif" v:shapes="_x0000_i1030"><![endif]><span
style='font-family:Palatino;text-decoration:none;text-underline:none'><o:p></o:p></span></h4>

<h3 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;font-weight:normal'>To
resume running the script, bring the script window to the front and click on
Follow or Go.<o:p></o:p></span></h3>

<h3 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;font-weight:normal'>When
a syntax or runtime error occurs, you can jump to the line where the error
occurred, with all script editing features enabled. You can view all local and
global variables before terminating the script.<o:p></o:p></span></h3>

<span style='font-size:18.0pt;font-family:Palatino;mso-ansi-language:EN-US'><b><br
clear=ALL style='page-break-before:always'>
</b></span>

<h2 style='margin-top:20.0pt'><span style='font-size:18.0pt;font-family:Palatino'>Storage
System<o:p></o:p></span></h2>

<h3 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;font-weight:normal'>Frontier’s
built-in storage system is called the object database. It can store small
objects like a user’s name, or the time of the last backup; or larger objects
like a list of users, a standard form letter, or a table of electronic mail
accounts. It makes it easy for scripts to communicate with each other,
especially scripts running in different threads. The object database is a
permanent data structure, so you don’t have to worry about complicated file
formats for your scripts.<o:p></o:p></span></h3>

<h3 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;font-weight:normal'>The
object database starts with a top-level table is called “root.” Start by
clicking on the flag in the Frontier’s main window. It reveals four buttons:<o:p></o:p></span></h3>

<h4 align=center style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;
margin-left:0in;margin-bottom:.0001pt;text-align:center'><!--[if gte vml 1]><v:shape
 id="_x0000_i1031" type="#_x0000_t75" style='width:402pt;height:50pt'>
 <v:imagedata src="NerdsGuideToFrontier_files/image019.gif" o:althref="NerdsGuideToFrontier_files/image020.pct"
  o:title=""/>
</v:shape><![endif]--><![if !vml]><img width=402 height=50
src="NerdsGuideToFrontier_files/image021.gif" v:shapes="_x0000_i1031"><![endif]><span
style='font-family:Palatino;text-decoration:none;text-underline:none'><o:p></o:p></span></h4>

<h3 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;font-weight:normal'>Click
on Object DB button. Frontier opens the “root” table:<o:p></o:p></span></h3>

<h4 align=center style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;
margin-left:0in;margin-bottom:.0001pt;text-align:center'><!--[if gte vml 1]><v:shape
 id="_x0000_i1032" type="#_x0000_t75" style='width:322pt;height:209pt'>
 <v:imagedata src="NerdsGuideToFrontier_files/image022.gif" o:althref="NerdsGuideToFrontier_files/image023.pct"
  o:title=""/>
</v:shape><![endif]--><![if !vml]><img width=322 height=209
src="NerdsGuideToFrontier_files/image024.gif" v:shapes="_x0000_i1032"><![endif]><span
style='font-family:Palatino;text-decoration:none;text-underline:none'><o:p></o:p></span></h4>

<span style='font-size:12.0pt;font-family:Palatino;mso-ansi-language:EN-US'><br
clear=ALL style='page-break-before:always'>
</span>

<h3 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;font-weight:normal'>There
are eight items at the top level of the database. Some are still on disk.
Frontier only reads in tables as they are needed. If you double-click on the
wedge next to examples, the sub-table opens:<o:p></o:p></span></h3>

<h4 align=center style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;
margin-left:0in;margin-bottom:.0001pt;text-align:center'><!--[if gte vml 1]><v:shape
 id="_x0000_i1033" type="#_x0000_t75" style='width:367pt;height:362pt'>
 <v:imagedata src="NerdsGuideToFrontier_files/image025.gif" o:althref="NerdsGuideToFrontier_files/image026.pct"
  o:title=""/>
</v:shape><![endif]--><![if !vml]><img width=367 height=362
src="NerdsGuideToFrontier_files/image027.gif" v:shapes="_x0000_i1033"><![endif]><span
style='font-family:Palatino;text-decoration:none;text-underline:none'><o:p></o:p></span></h4>

<h3 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;font-weight:normal'>Values
can be small things like booleans, characters and numbers; or large things like
strings, word processing text, outlines or scripts. Frontier supports over 20
built-in types, and has a general type called “binary” which allows you to
store types which Frontier doesn’t directly support.<o:p></o:p></span></h3>

<h3 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;font-weight:normal'>The
Kind popup menu allows you to change the type of an object. The Sort popup
allows you to change the order in which objects are displayed in the window.<o:p></o:p></span></h3>

<h3 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;font-weight:normal'>The
storage system uses a 31-bit internal address, so files can be huge, limited
only by available disk space. Even though the database is disk-based, Frontier
has a Save command, and even a Revert command, allowing you to roll back to the
previous version of the database.<o:p></o:p></span></h3>

<h3 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;font-weight:normal'>From
scripts, you use dot-syntax to traverse the table hierarchy. For example, to
add 1 to the number “age” stored in the “examples” table you say examples.age =
examples.age + 1. You could also say examples.age++.<o:p></o:p></span></h3>

<h3 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;font-weight:normal'>Because
database paths can get long, UserTalk has a “with” statement, like Pascal’s,
that lets you easily work with deeply-nested tables. The following script
launches MacWrite, brings it to the front, opens and prints a document and
quits:<o:p></o:p></span></h3>

<h4 style='margin-top:2.35pt;margin-right:0in;margin-bottom:2.35pt;margin-left:
.2in'><span style='font-size:9.0pt;font-family:Geneva;text-decoration:none;
text-underline:none'>with system.verbs.apps.MacWrite<o:p></o:p></span></h4>

<h5 style='margin-top:2.35pt;margin-right:0in;margin-bottom:2.35pt;margin-left:
.4in'><span style='font-size:9.0pt;font-family:Geneva;font-weight:normal'>launch
()<o:p></o:p></span></h5>

<h5 style='margin-top:2.35pt;margin-right:0in;margin-bottom:2.35pt;margin-left:
.4in'><span style='font-size:9.0pt;font-family:Geneva;font-weight:normal'>bringToFront
()<o:p></o:p></span></h5>

<h5 style='margin-top:2.35pt;margin-right:0in;margin-bottom:2.35pt;margin-left:
.4in'><span style='font-size:9.0pt;font-family:Geneva;font-weight:normal'>printDocument
(&quot;System:Business Plan&quot;)<o:p></o:p></span></h5>

<h5 style='margin-top:2.35pt;margin-right:0in;margin-bottom:2.35pt;margin-left:
.4in'><span style='font-size:9.0pt;font-family:Geneva;font-weight:normal'>quit ()<o:p></o:p></span></h5>

<h3 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;font-weight:normal'>Frontier
has another mechanism to help simplify deeply nested values, the paths table.
Like Unix or MS-DOS, the paths table defines a set of object database tables
that are globally accessible. Because system.verbs.apps is in the paths table,
it’s possible to re-write the previous script as:<o:p></o:p></span></h3>

<h4 style='margin-top:2.35pt;margin-right:0in;margin-bottom:2.35pt;margin-left:
.2in'><span style='font-size:9.0pt;font-family:Geneva;text-decoration:none;
text-underline:none'>MacWrite.launch ()<o:p></o:p></span></h4>

<h4 style='margin-top:2.35pt;margin-right:0in;margin-bottom:2.35pt;margin-left:
.2in'><span style='font-size:9.0pt;font-family:Geneva;text-decoration:none;
text-underline:none'>MacWrite.bringToFront ()<o:p></o:p></span></h4>

<h4 style='margin-top:2.35pt;margin-right:0in;margin-bottom:2.35pt;margin-left:
.2in'><span style='font-size:9.0pt;font-family:Geneva;text-decoration:none;
text-underline:none'>MacWrite.printDocument (&quot;System:Business Plan&quot;)<o:p></o:p></span></h4>

<h4 style='margin-top:2.35pt;margin-right:0in;margin-bottom:2.35pt;margin-left:
.2in'><span style='font-size:9.0pt;font-family:Geneva;text-decoration:none;
text-underline:none'>MacWrite.quit ()<o:p></o:p></span></h4>

<h3 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;font-weight:normal'>Another
special table is system.agents. Any script in system.agents is executed once
per second. Here’s a very simple agent that adds 1 to a counter once a second
and displays the result in Frontier’s main window:<o:p></o:p></span></h3>

<h4 style='margin-top:2.35pt;margin-right:0in;margin-bottom:2.35pt;margin-left:
.2in'><span style='font-size:9.0pt;font-family:Geneva;text-decoration:none;
text-underline:none'>msg (scratchpad.count++)<o:p></o:p></span></h4>

<h3 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;font-weight:normal'>If
you want to count once a minute:<o:p></o:p></span></h3>

<h4 style='margin-top:2.35pt;margin-right:0in;margin-bottom:2.35pt;margin-left:
.2in'><span style='font-size:9.0pt;font-family:Geneva;text-decoration:none;
text-underline:none'>msg (scratchpad.count++)<o:p></o:p></span></h4>

<h4 style='margin-top:2.35pt;margin-right:0in;margin-bottom:2.35pt;margin-left:
.2in'><span style='font-size:9.0pt;font-family:Geneva;text-decoration:none;
text-underline:none'>clock.sleepFor (60)<o:p></o:p></span></h4>

<h3 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;font-weight:normal'>Agent
scripts are used to monitor folders, especially on shared disks. A server
running Frontier or Frontier Runtime can run an agent script that watches the
folder. When a file appears in the special folder, the agent script processes
it in some fashion.<o:p></o:p></span></h3>

<h3 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;font-weight:normal'>In
addition to agent scripts, there are special tables for scripts that run on
startup and shutdown, or scripts that respond to incoming Apple Event messages.
Even the interpreter’s runtime stack is accessible thru the object database
hierarchy.<o:p></o:p></span></h3>

<h3 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;font-weight:normal'>Much
of the culture of Frontier is implemented as scripts stored in the object
database, so you can examine and customize the scripts and add your own. When
we upgrade Frontier, we only upgrade the parts of the database that we created,
and leave the parts that are subject to customization untouched.<o:p></o:p></span></h3>

<span style='font-size:18.0pt;font-family:Palatino;mso-ansi-language:EN-US'><b><br
clear=ALL style='page-break-before:always'>
</b></span>

<h2 style='margin-top:20.0pt'><span style='font-size:18.0pt;font-family:Palatino'>Menubar
editor, Menu Sharing<o:p></o:p></span></h2>

<h3 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;font-weight:normal'>Like
Frontier’s script editor, the menu editor works with an outline. The outline is
hot-wired to the actual Macintosh system menu bar. When you make a change in
the menu editor it’s immediately reflected in the system menu bar. In the
following screen shot, the script writer is editing the Graphics sub-menu of
the Work menu in Frontier’s menu bar:<o:p></o:p></span></h3>

<h4 align=center style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;
margin-left:0in;margin-bottom:.0001pt;text-align:center'><!--[if gte vml 1]><v:shape
 id="_x0000_i1034" type="#_x0000_t75" style='width:364pt;height:343pt'>
 <v:imagedata src="NerdsGuideToFrontier_files/image028.gif" o:althref="NerdsGuideToFrontier_files/image029.pct"
  o:title=""/>
</v:shape><![endif]--><![if !vml]><img width=364 height=343
src="NerdsGuideToFrontier_files/image030.gif" v:shapes="_x0000_i1034"><![endif]><span
style='font-family:Palatino;text-decoration:none;text-underline:none'><o:p></o:p></span></h4>

<h3 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;font-weight:normal'>The
outline hierarchy is reflected in hierarchical menus. Each main heading is a
menu, each sub-head is a command or a sub-menu. To edit the script linked into
each menu item, click on the Script button (it’s hidden in the screen shot
above). A script window opens.<o:p></o:p></span></h3>

<h3 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;font-weight:normal'>This
menu editor can also be used to add commands to applications that support the
Apple Event-based <u>menu sharing</u> protocol. Examples include Think C and
Symantec C++ 6.0, Quark XPress 3.2, Storm Technologies PicturePress 2.0, and
StuffIt Deluxe 3.0 and StuffIt Lite 3.0 from Aladdin Systems. Thru the
FinderMenu extension, included with Frontier 2.0, you can add commands to the
Finder’s menu bar.<o:p></o:p></span></h3>

<span style='font-size:12.0pt;font-family:Palatino;mso-ansi-language:EN-US'><br
clear=ALL style='page-break-before:always'>
</span>

<h3 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;font-weight:normal'>To
see how menu sharing works from a script writer’s perspective, open the table
at system.menubars:<o:p></o:p></span></h3>

<h4 align=center style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;
margin-left:0in;margin-bottom:.0001pt;text-align:center'><!--[if gte vml 1]><v:shape
 id="_x0000_i1035" type="#_x0000_t75" style='width:322pt;height:294pt'>
 <v:imagedata src="NerdsGuideToFrontier_files/image031.gif" o:althref="NerdsGuideToFrontier_files/image032.pct"
  o:title=""/>
</v:shape><![endif]--><![if !vml]><img width=322 height=294
src="NerdsGuideToFrontier_files/image033.gif" v:shapes="_x0000_i1035"><![endif]><span
style='font-family:Palatino;text-decoration:none;text-underline:none'><o:p></o:p></span></h4>

<h3 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;font-weight:normal'>This
table associates a menubar object with a Macintosh application that supports
menu sharing. KAHL contains the shared menu for Think Project Manager. XPR3
contains the shared menu for Quark XPress 3.2. When one of these applications
launches, it sends a series of Apple Events to Frontier to request its shared
menus. When the user selects one of the commands, the application sends a message
to Frontier to run the script that the user selected.<o:p></o:p></span></h3>

<h3 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;font-weight:normal'>Frontier
Software Developer Kit (or Frontier SDK) includes the Menu Sharing Toolkit
which makes it easy for developers to open their menubars to script writers. It
can be downloaded from any of UserLand’s on-line services and is included in
the Frontier 2.0 package. All UserLand developer toolkits are royalty-free and
provided in full C source code.<o:p></o:p></span></h3>

<span style='font-size:18.0pt;font-family:Palatino;mso-ansi-language:EN-US'><b><br
clear=ALL style='page-break-before:always'>
</b></span>

<h2 style='margin-top:20.0pt'><span style='font-size:18.0pt;font-family:Palatino'>Scripts
on the Desktop<o:p></o:p></span></h2>

<h3 style='margin-top:14.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino'>Desktop Scripts<o:p></o:p></span></h3>

<h4 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;text-decoration:
none;text-underline:none'>Desktop scripts are files that contain a script that
runs when the file is double-clicked on. The script can be programmed to
operate on the folder it was launched from. <o:p></o:p></span></h4>

<h4 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;text-decoration:
none;text-underline:none'>To create a new desktop script, choose the New
Desktop Script command in Frontier’s UserLand menu. A new script is created in
the system.deskscripts table. To export it, choose the Export a Desktop Script
command from the Export sub-menu of the UserLand menu.<o:p></o:p></span></h4>

<h4 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;text-decoration:
none;text-underline:none'>The following desktop script searches the folder it
was launched from for TeachText files. When it finds one the script changes its
creator id so that Microsoft Word will open it.<o:p></o:p></span></h4>

<h5 style='margin-top:2.35pt;margin-right:0in;margin-bottom:2.35pt;margin-left:
.2in'><span style='font-size:9.0pt;font-family:Geneva;font-weight:normal'>local
(f, folder)<o:p></o:p></span></h5>

<h5 style='margin-top:2.35pt;margin-right:0in;margin-bottom:2.35pt;margin-left:
.2in'><span style='font-size:9.0pt;font-family:Geneva;font-weight:normal'>folder
= file.folderFromPath (system.deskscripts.path)<o:p></o:p></span></h5>

<h5 style='margin-top:2.35pt;margin-right:0in;margin-bottom:2.35pt;margin-left:
.2in'><span style='font-size:9.0pt;font-family:Geneva;font-weight:normal'>fileloop
(f in folder, infinity)<o:p></o:p></span></h5>

<h6 style='margin-top:2.35pt;margin-right:0in;margin-bottom:2.35pt;margin-left:
.4in'><span style='font-size:9.0pt;font-family:Geneva;text-decoration:none;
text-underline:none'>if file.creator (f) equals 'ttxt'<o:p></o:p></span></h6>

<p class=MsoHeading7 style='margin-top:2.35pt;margin-right:0in;margin-bottom:
2.35pt;margin-left:.6in'><span style='font-size:9.0pt;font-family:Geneva;
font-style:normal'>file.setCreator (f, 'MSWD')<o:p></o:p></span></p>

<h4 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;text-decoration:
none;text-underline:none'>Before a desktop script runs, Frontier sets up
system.deskscripts.path so that it contains the full path to the desktop script
file. The script can loop over all files in a folder, or store information in
the resource fork of the script file.<o:p></o:p></span></h4>

<h4 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;text-decoration:
none;text-underline:none'>Here’s what a desktop script looks like in the
Finder: <o:p></o:p></span></h4>

<h5 align=center style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;
margin-left:0in;margin-bottom:.0001pt;text-align:center'><!--[if gte vml 1]><v:shape
 id="_x0000_i1036" type="#_x0000_t75" style='width:214pt;height:70pt'>
 <v:imagedata src="NerdsGuideToFrontier_files/image034.gif" o:althref="NerdsGuideToFrontier_files/image035.pct"
  o:title=""/>
 <w:bordertop type="single" width="12"/>
 <w:borderleft type="single" width="12"/>
 <w:borderbottom type="single" width="12"/>
 <w:borderright type="single" width="12"/>
</v:shape><![endif]--><![if !vml]><img width=216 height=72
src="NerdsGuideToFrontier_files/image036.gif" v:shapes="_x0000_i1036"><![endif]><span
style='font-size:12.0pt;font-family:Palatino;font-weight:normal'><o:p></o:p></span></h5>

<h4 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;text-decoration:
none;text-underline:none'>If you run the script in the same folder as the
TeachText Files folder, it changes all the TeachText files to Word files.<o:p></o:p></span></h4>

<span style='font-size:12.0pt;font-family:Palatino;mso-ansi-language:EN-US'><b><br
clear=ALL style='page-break-before:always'>
</b></span>

<h3 style='margin-top:14.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino'>Droplet Scripts<o:p></o:p></span></h3>

<h4 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;text-decoration:
none;text-underline:none'>Droplets are small applications that have an embedded
script that runs once for each file, folder or disk icon that’s dropped onto
the application. <o:p></o:p></span></h4>

<h4 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;text-decoration:
none;text-underline:none'>Frontier communicates with the droplet script through
the system.droplet table. The script can also use this table to store values
that persist across calls to the script. In the following example, the droplet
keeps track of the amount of disk space it reclaimed in
system.droplet.bytessaved.<o:p></o:p></span></h4>

<h4 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;text-decoration:
none;text-underline:none'>Here’s a droplet script that searches the folders
dropped on it for Think C project files. It opens each project, removes all
objects, and closes the project. It automatically launches Think Project
Manager if it's not running. As it finishes, it reports the amount of disk
space reclaimed:<o:p></o:p></span></h4>

<h5 style='margin-top:2.35pt;margin-right:0in;margin-bottom:2.35pt;margin-left:
.2in'><span style='font-size:9.0pt;font-family:Geneva;font-weight:normal'>if
system.droplet.startup<o:p></o:p></span></h5>

<h6 style='margin-top:2.35pt;margin-right:0in;margin-bottom:2.35pt;margin-left:
.4in'><span style='font-size:9.0pt;font-family:Geneva;text-decoration:none;
text-underline:none'>system.droplet.bytessaved = 0 «keeps track of space we
reclaimed<o:p></o:p></span></h6>

<h5 style='margin-top:2.35pt;margin-right:0in;margin-bottom:2.35pt;margin-left:
.2in'><span style='font-size:9.0pt;font-family:Geneva;font-weight:normal'>if
system.droplet.closedown<o:p></o:p></span></h5>

<h6 style='margin-top:2.35pt;margin-right:0in;margin-bottom:2.35pt;margin-left:
.4in'><span style='font-size:9.0pt;font-family:Geneva;text-decoration:none;
text-underline:none'>if system.droplet.bytessaved &gt; 0 «report to the user<o:p></o:p></span></h6>

<p class=MsoHeading7 style='margin-top:2.35pt;margin-right:0in;margin-bottom:
2.35pt;margin-left:.6in'><span style='font-size:9.0pt;font-family:Geneva;
font-style:normal'>dialog.notify (string.kBytes (system.droplet.bytessaved) +
&quot; reclaimed.&quot;)<o:p></o:p></span></p>

<h6 style='margin-top:2.35pt;margin-right:0in;margin-bottom:2.35pt;margin-left:
.4in'><span style='font-size:9.0pt;font-family:Geneva;text-decoration:none;
text-underline:none'>delete (@system.droplet.bytessaved)<o:p></o:p></span></h6>

<h6 style='margin-top:2.35pt;margin-right:0in;margin-bottom:2.35pt;margin-left:
.4in'><span style='font-size:9.0pt;font-family:Geneva;text-decoration:none;
text-underline:none'>return<o:p></o:p></span></h6>

<h5 style='margin-top:2.35pt;margin-right:0in;margin-bottom:2.35pt;margin-left:
.2in'><span style='font-size:9.0pt;font-family:Geneva;font-weight:normal'>on
checkfile (f)<o:p></o:p></span></h5>

<h6 style='margin-top:2.35pt;margin-right:0in;margin-bottom:2.35pt;margin-left:
.4in'><span style='font-size:9.0pt;font-family:Geneva;text-decoration:none;
text-underline:none'>if think.isProjectFile (f)<o:p></o:p></span></h6>

<p class=MsoHeading7 style='margin-top:2.35pt;margin-right:0in;margin-bottom:
2.35pt;margin-left:.6in'><span style='font-size:9.0pt;font-family:Geneva;
font-style:normal'>local (origfilesize = file.size (f))<o:p></o:p></span></p>

<p class=MsoHeading7 style='margin-top:2.35pt;margin-right:0in;margin-bottom:
2.35pt;margin-left:.6in'><span style='font-size:9.0pt;font-family:Geneva;
font-style:normal'>think.openProject (f)<o:p></o:p></span></p>

<p class=MsoHeading7 style='margin-top:2.35pt;margin-right:0in;margin-bottom:
2.35pt;margin-left:.6in'><span style='font-size:9.0pt;font-family:Geneva;
font-style:normal'>think.removeObjects ()<o:p></o:p></span></p>

<p class=MsoHeading7 style='margin-top:2.35pt;margin-right:0in;margin-bottom:
2.35pt;margin-left:.6in'><span style='font-size:9.0pt;font-family:Geneva;
font-style:normal'>think.closeProject (true)<o:p></o:p></span></p>

<p class=MsoHeading7 style='margin-top:2.35pt;margin-right:0in;margin-bottom:
2.35pt;margin-left:.6in'><span style='font-size:9.0pt;font-family:Geneva;
font-style:normal'>system.droplet.bytessaved = system.droplet.bytessaved +
(origfilesize - file.size (f))<o:p></o:p></span></p>

<h5 style='margin-top:2.35pt;margin-right:0in;margin-bottom:2.35pt;margin-left:
.2in'><span style='font-size:9.0pt;font-family:Geneva;font-weight:normal'>if
file.isFolder (system.droplet.path)<o:p></o:p></span></h5>

<h6 style='margin-top:2.35pt;margin-right:0in;margin-bottom:2.35pt;margin-left:
.4in'><span style='font-size:9.0pt;font-family:Geneva;text-decoration:none;
text-underline:none'>local (f)<o:p></o:p></span></h6>

<h6 style='margin-top:2.35pt;margin-right:0in;margin-bottom:2.35pt;margin-left:
.4in'><span style='font-size:9.0pt;font-family:Geneva;text-decoration:none;
text-underline:none'>fileloop (f in system.droplet.path, infinity)<o:p></o:p></span></h6>

<p class=MsoHeading7 style='margin-top:2.35pt;margin-right:0in;margin-bottom:
2.35pt;margin-left:.6in'><span style='font-size:9.0pt;font-family:Geneva;
font-style:normal'>checkfile (f)<o:p></o:p></span></p>

<h5 style='margin-top:2.35pt;margin-right:0in;margin-bottom:2.35pt;margin-left:
.2in'><span style='font-size:9.0pt;font-family:Geneva;font-weight:normal'>else<o:p></o:p></span></h5>

<h6 style='margin-top:2.35pt;margin-right:0in;margin-bottom:2.35pt;margin-left:
.4in'><span style='font-size:9.0pt;font-family:Geneva;text-decoration:none;
text-underline:none'>checkfile (f)<o:p></o:p></span></h6>

<span style='font-size:12.0pt;font-family:Palatino;mso-ansi-language:EN-US'><br
clear=ALL style='page-break-before:always'>
</span>

<h4 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;text-decoration:
none;text-underline:none'>This is what a droplet looks like on the desktop:<o:p></o:p></span></h4>

<h5 align=center style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;
margin-left:0in;margin-bottom:.0001pt;text-align:center'><!--[if gte vml 1]><v:shape
 id="_x0000_i1037" type="#_x0000_t75" style='width:234pt;height:66pt'>
 <v:imagedata src="NerdsGuideToFrontier_files/image037.gif" o:althref="NerdsGuideToFrontier_files/image038.pct"
  o:title=""/>
 <w:bordertop type="single" width="12"/>
 <w:borderleft type="single" width="12"/>
 <w:borderbottom type="single" width="12"/>
 <w:borderright type="single" width="12"/>
</v:shape><![endif]--><![if !vml]><img width=236 height=68
src="NerdsGuideToFrontier_files/image039.gif" v:shapes="_x0000_i1037"><![endif]><span
style='font-size:12.0pt;font-family:Palatino;font-weight:normal'><o:p></o:p></span></h5>

<h4 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;text-decoration:
none;text-underline:none'>Drag the Project Files folder onto the Remove Objects
icon. Here’s what you see:<o:p></o:p></span></h4>

<h5 align=center style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;
margin-left:0in;margin-bottom:.0001pt;text-align:center'><!--[if gte vml 1]><v:shape
 id="_x0000_i1038" type="#_x0000_t75" style='width:393pt;height:231pt'>
 <v:imagedata src="NerdsGuideToFrontier_files/image040.gif" o:althref="NerdsGuideToFrontier_files/image041.pct"
  o:title=""/>
 <w:bordertop type="single" width="12"/>
 <w:borderleft type="single" width="12"/>
 <w:borderbottom type="single" width="12"/>
 <w:borderright type="single" width="12"/>
</v:shape><![endif]--><![if !vml]><img width=395 height=233
src="NerdsGuideToFrontier_files/image042.gif" v:shapes="_x0000_i1038"><![endif]><span
style='font-size:12.0pt;font-family:Palatino;font-weight:normal'><o:p></o:p></span></h5>

<h4 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;text-decoration:
none;text-underline:none'>Droplets are menu-sharing-aware, so you can include
configuration commands in the droplet’s menu bar, implemented as scripts.<o:p></o:p></span></h4>

<h4 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;text-decoration:
none;text-underline:none'>A full tutorial and reference guide, sample code, and
source for the Droplet Developer Kit is available in the Extras folder of
Frontier SDK.<o:p></o:p></span></h4>

<span style='font-size:18.0pt;font-family:Palatino;mso-ansi-language:EN-US'><b><br
clear=ALL style='page-break-before:always'>
</b></span>

<h2 style='margin-top:20.0pt'><span style='font-size:18.0pt;font-family:Palatino'>DocServer<o:p></o:p></span></h2>

<h3 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;font-weight:normal'>DocServer
is the on-line documentation tool for Frontier script writers. Each “page” in
the DocServer database describes one of the UserTalk language verbs. The
example below shows the docs for the file.exists verb. Information on the
syntax, parameters, action and returned value of the verb are included. <o:p></o:p></span></h3>

<h4 align=center style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;
margin-left:0in;margin-bottom:.0001pt;text-align:center'><!--[if gte vml 1]><v:shape
 id="_x0000_i1039" type="#_x0000_t75" style='width:472pt;height:362pt'>
 <v:imagedata src="NerdsGuideToFrontier_files/image043.gif" o:althref="NerdsGuideToFrontier_files/image044.pct"
  o:title=""/>
</v:shape><![endif]--><![if !vml]><img width=472 height=362
src="NerdsGuideToFrontier_files/image045.gif" v:shapes="_x0000_i1039"><![endif]><span
style='font-family:Palatino;text-decoration:none;text-underline:none'><o:p></o:p></span></h4>

<h3 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;font-weight:normal'>DocServer
is connected to Frontier thru Apple Events. If you select a name in Frontier,
and hold down the Control key while double-clicking on it, DocServer will
display the documentation for that verb.<o:p></o:p></span></h3>

<h3 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;font-weight:normal'>DocServer
is an open tool. Other developers are encouraged to provide Apple Event verb
documentation in DocServer format.<o:p></o:p></span></h3>

<span style='font-size:18.0pt;font-family:Palatino;mso-ansi-language:EN-US'><b><br
clear=ALL style='page-break-before:always'>
</b></span>

<h2 style='margin-top:20.0pt'><span style='font-size:18.0pt;font-family:Palatino'>Architecture
&amp; Economics<o:p></o:p></span></h2>

<h3 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;font-weight:normal'>Frontier
scripts can run over AppleTalk-compatible networks, sending messages to other
copies of Frontier or Runtime, or to other Apple Event-aware applications. <o:p></o:p></span></h3>

<h3 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;font-weight:normal'>Scripts
are re-usable. Scripts can call other scripts, passing parameters and receiving
returned values. Script writers can add new verbs to the language.<o:p></o:p></span></h3>

<h3 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;font-weight:normal'>Scripts
can be compiled into an intermediate non-human-readable form. In an upcoming
release of Frontier it will be possible to distribute scripts in this form.<o:p></o:p></span></h3>

<h3 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;font-weight:normal'>Compiled
machine code can be stored in the object database and called exactly as scripts
are called. Two communication protocols are supported: the well-known HyperCard
1.0 XFCN protocol and a new and more powerful protocol known as UCMD, which is
compatible with the AppleScript OSAX protocol. Toolkits for developing both
kinds of code resources is included in Frontier SDK 2.0.<o:p></o:p></span></h3>

<h3 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;font-weight:normal'>The
language is case-insensitive. fileFromPath is the same identifier as
filefrompath and FiLeFRoMPAtH.<o:p></o:p></span></h3>

<h3 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;font-weight:normal'>Frontier
is multi-threaded. Each script runs in its own thread, and can use the object
database to communicate with each other and for synchronization.<o:p></o:p></span></h3>

<h3 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;font-weight:normal'>On-line
support is provided thru CompuServe, America On-Line and AppleLink. Support
forums are staffed by Frontier’s lead developers. Sample scripts, toolkits, and
documentation, all without additional charge, can be downloaded from UserLand’s
on-line support services:<o:p></o:p></span></h3>

<h4 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
.3in;margin-bottom:.0001pt;text-indent:-13.0pt'><span style='font-family:Palatino;
text-decoration:none;text-underline:none'>•<span style='mso-tab-count:1'>&nbsp; </span>CompuServe:
Type GO USERLAND at any ! prompt.<o:p></o:p></span></h4>

<h4 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
.3in;margin-bottom:.0001pt;text-indent:-13.0pt'><span style='font-family:Palatino;
text-decoration:none;text-underline:none'>•<span style='mso-tab-count:1'>&nbsp; </span>America
On-Line: Keyword USERLAND.<o:p></o:p></span></h4>

<h4 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
.3in;margin-bottom:.0001pt;text-indent:-13.0pt'><span style='font-family:Palatino;
text-decoration:none;text-underline:none'>•<span style='mso-tab-count:1'>&nbsp; </span>AppleLink:
UserLand Discussions under Third Parties.<o:p></o:p></span></h4>

<h3 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;font-weight:normal'>Frontier
Runtime runs scripts, but has no interactive script editing or debugging
features. It’s available as an inexpensive shareware package, with a 30-day
free trial period. Network site licenses are available for as little as $20 per
machine for networks with more than 10 Runtime users. Runtime can be bundled
with commercial applications that support Apple Events for $100 per year, no
royalty. All prices are in U.S. dollars.<o:p></o:p></span></h3>

<h3 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;font-weight:normal'>A
special shareware Scripting Starter Kit (SSK) is available for Think C and
Symantec C++ 6.0 developers. It can be downloaded from any of UserLand’s
on-line services.<o:p></o:p></span></h3>

<h3 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;font-weight:normal'>Frontier
is a commercial product with a suggested retail price of $249.<o:p></o:p></span></h3>

<h3 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;font-weight:normal'>Both
Frontier and Frontier Runtime require System 7.0 or greater. Frontier requires
a minimum of 1024K, Frontier Runtime requires 512K.<o:p></o:p></span></h3>

<span style='font-size:18.0pt;font-family:Palatino;mso-ansi-language:EN-US'><b><br
clear=ALL style='page-break-before:always'>
</b></span>

<h2 style='margin-top:20.0pt'><span style='font-size:18.0pt;font-family:Palatino'>Q&amp;A<o:p></o:p></span></h2>

<h3 style='margin-top:14.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino'>Why would I add
Frontier capability over AppleScript?<o:p></o:p></span></h3>

<h4 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;text-decoration:
none;text-underline:none'>Both AppleScript and Frontier build on the same
protocol: Apple Events. It’s impossible to support one without supporting the other.<o:p></o:p></span></h4>

<h4 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;text-decoration:
none;text-underline:none'>The only extra protocol we ask you to support is menu
sharing. You should add it because script writers want it, and it’s very easy
to implement.<o:p></o:p></span></h4>

<h3 style='margin-top:14.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino'>How do I make
verbs for my app?<o:p></o:p></span></h3>

<h4 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;text-decoration:
none;text-underline:none'>Suppose your app, named mathApp, implements a single
Apple Event that takes one parameter, a long. It multiplies it by two, and
returns the result. <o:p></o:p></span></h4>

<h4 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;text-decoration:
none;text-underline:none'>Create a new table for your application at
system.verbs.apps.mathApp. Create a new script in that table, call it
“doubler”. Here’s what the script looks like:<o:p></o:p></span></h4>

<h5 style='margin-top:2.35pt;margin-right:0in;margin-bottom:2.35pt;margin-left:
.2in'><span style='font-size:9.0pt;font-family:Geneva;font-weight:normal'>on
doubler (x)<o:p></o:p></span></h5>

<h6 style='margin-top:2.35pt;margin-right:0in;margin-bottom:2.35pt;margin-left:
.4in'><span style='font-size:9.0pt;font-family:Geneva;text-decoration:none;
text-underline:none'>return (appleEvent ('MIKE', 'CUST', 'DOUB', '----', long
(x)))<o:p></o:p></span></h6>

<h4 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;text-decoration:
none;text-underline:none'>It returns the value of a call to Frontier's built-in
appleEvent verb. 'MIKE' is the creator id of mathApp, 'CUST' is the class of
the verb, 'DOUB' is the verb identifier. The next two parameters provide the
key, '----', and the value of the single long parameter to the Apple Event. <o:p></o:p></span></h4>

<h4 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;text-decoration:
none;text-underline:none'>A script writer can then call your verb exactly as if
it built into the language. Here's an example that displays 24 in a standard
alert dialog:<o:p></o:p></span></h4>

<h5 style='margin-top:2.35pt;margin-right:0in;margin-bottom:2.35pt;margin-left:
.2in'><span style='font-size:9.0pt;font-family:Geneva;font-weight:normal'>dialog.alert
(mathApp.doubler (12))<o:p></o:p></span></h5>

<h4 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;text-decoration:
none;text-underline:none'>Full details are provided in Frontier SDK 2.0, Extras
folder, Frontier Install File Creator sub-folder. <o:p></o:p></span></h4>

<span style='font-size:12.0pt;font-family:Palatino;mso-ansi-language:EN-US'><b><br
clear=ALL style='page-break-before:always'>
</b></span>

<h3 style='margin-top:14.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino'>How long does it
take to add menu sharing to my app?<o:p></o:p></span></h3>

<h4 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;text-decoration:
none;text-underline:none'>You add calls to Menu Sharing Toolkit routines in
five places:<o:p></o:p></span></h4>

<h5 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
.3in;margin-bottom:.0001pt;text-indent:-15.0pt'><span style='font-size:12.0pt;
font-family:Palatino;font-weight:normal'>1.<span style='mso-tab-count:1'>&nbsp; </span>Where
you initialize Macintosh toolkits. [Add a call to InitSharedMenus to set up
globals and install handlers for messages sent by the menu sharing server.]<o:p></o:p></span></h5>

<h5 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
.3in;margin-bottom:.0001pt;text-indent:-15.0pt'><span style='font-size:12.0pt;
font-family:Palatino;font-weight:normal'>2.<span style='mso-tab-count:1'>&nbsp; </span>In
your menu handling routine. [Call SharedMenuHit to filter out shared menu
selections. If it returns false, process the menu selection normally, if it
returns true, it was a shared menu command, return to your main event loop.]<o:p></o:p></span></h5>

<h5 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
.3in;margin-bottom:.0001pt;text-indent:-15.0pt'><span style='font-size:12.0pt;
font-family:Palatino;font-weight:normal'>3.<span style='mso-tab-count:1'>&nbsp; </span>In
your keystroke handler. [Call CancelSharedScript if the user hits cmd-period
and SharedScriptRunning returns true. Otherwise, process the keystroke as you
normally would.]<o:p></o:p></span></h5>

<h5 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
.3in;margin-bottom:.0001pt;text-indent:-15.0pt'><span style='font-size:12.0pt;
font-family:Palatino;font-weight:normal'>4.<span style='mso-tab-count:1'>&nbsp; </span>In
your event handler. [On receipt of a null event, call CheckSharedMenus to load
the shared menus, or reload them if they changed.]<o:p></o:p></span></h5>

<h5 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
.3in;margin-bottom:.0001pt;text-indent:-15.0pt'><span style='font-size:12.0pt;
font-family:Palatino;font-weight:normal'>5.<span style='mso-tab-count:1'>&nbsp; </span>In
each Apple Event handler. [Call the toolkit routine SharedScriptCancelled . If
it returns true, your handler should returns noErr immediately.]<o:p></o:p></span></h5>

<h4 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;text-decoration:
none;text-underline:none'>If you’re working in Think C or Symantec C++ it could
take as little as 20 minutes to find these places and add the calls. There’s a
reasonably good chance it will work the first time, as it has for many others.<o:p></o:p></span></h4>

<h4 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;text-decoration:
none;text-underline:none'>A full tutorial and reference guide, sample code, and
source for the Menu Sharing Toolkit is available in the Toolkits folder of
Frontier SDK.<o:p></o:p></span></h4>

<h2 style='margin-top:20.0pt'><span style='font-size:18.0pt;font-family:Palatino'>Final
Note<o:p></o:p></span></h2>

<h3 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;font-weight:normal'>If
you have any questions, comments or suggestions, please get in touch through
one of UserLand’s on-line services. If you’re an AppleLink user, check out the
UserLand Discussion Board under the Third Parties icon. On CompuServe, visit
the UserLand Forum in the Computing Support section, or enter GO USERLAND at
any ! prompt. On America On-Line, enter the keyword USERLAND.<o:p></o:p></span></h3>

<h2 style='margin-top:20.0pt'><span style='font-size:18.0pt;font-family:Palatino'>About
the Author<o:p></o:p></span></h2>

<h3 style='margin-top:7.0pt;margin-right:0in;margin-bottom:0in;margin-left:
0in;margin-bottom:.0001pt'><span style='font-family:Palatino;font-weight:normal'>Dave
Winer is founder and president of UserLand Software. He and Doug Baron are the
lead developers at UserLand. Dave has been a commercial software developer
since 1979, and shipped his first product, the ThinkTank outliner for the Apple
II in 1983. The IBM PC version shipped in 1984. As founder and president of
Living Videotext, Inc. he shipped one of the first Macintosh applications,
ThinkTank 128, in mid-1984, and in 1986 shipped the award-winning MORE 1.0,
followed by MORE 1.1c in 1987. Living Videotext merged with Symantec shortly
after that and Dave moved on to start the development of Frontier. Frontier 2.0
received MacUser’s Eddy award for best development tool of 1992. <o:p></o:p></span></h3>

</div>

</body>

</html>
